```{asciicast}
#| include: FALSE
pkgload::load_all()
```

### Create a tsjsonc object

Create a tsjsonc object from a string:

```{asciicast}
#| results: hide
txt <- r"(
// this is a comment
{
  "a": {
    "a1": [1, 2, 3],
    // comment
    "a2": "string"
  },
  "b": [
    {
      "b11": true,
      "b12": false
    },
    {
      "b21": false,
      "b22": false
    }
  ]
}
)"
json <- ts_parse_jsonc(text = txt)
```

Pretty print a tsjsonc object:

```{asciicast}
#| label: print-json
json
```

### Select elements in a tsjsonc object

Select element by objects key:

```{asciicast}
#| label: select-key
ts_tree_select(json, "a")
```

Select element inside element:

```{asciicast}
#| label: select-select
ts_tree_select(json, "a", "a1")
```

Select element(s) of an array:

```{asciicast}
#| label: select-array
ts_tree_select(json, "a", "a1", 1:2)
```

Select multiple keys from an object:

```{asciicast}
#| label: select-multiple
ts_tree_select(json, "a", c("a1", "a2"))
```

Select nodes that match a tree-sitter query:

```{asciicast}
#| label: select-query
json |> ts_tree_select_query("((pair value: (false) @val))")
```

### Delete elements

Delete selected elements:

```{asciicast}
#| label: delete
ts_tree_select(json, "a", "a1") |> ts_tree_delete()
```

### Insert elements

Insert element into an array:

```{asciicast}
#| label: insert-array
ts_tree_select(json, "a", "a1") |> ts_tree_insert(at = 2, "new")
```

Inserting into an array reformats the array.

Insert element into an object, at the specified key:

```{asciicast}
#| label: insert-object
ts_tree_select(json, "a") |>
  ts_tree_insert(key = "a0", at = 0, list("new", "element"))
```

### Update elements

Update existing element:

```{asciicast}
#| label: update
ts_tree_select(json, "a", c("a1", "a2")) |> ts_tree_update("new value")
```

Inserts the element if some parents are missing:

```{asciicast}
#| label: update-insert
json <- ts_parse_jsonc(text = "{ \"a\": { \"b\": true } }")
json
```

```{asciicast}
#| label: update-insert-2
ts_tree_select(json, "a", "x", "y") |> ts_tree_update(list(1,2,3))
```